#!2025-11-09
#!raw=https://raw.githubusercontent.com/jianh-ai/klax/main/conf/conf.yaml
#!raw=https://cdn.jsdelivr.net/gh/jianh-ai/klax@main/conf/conf.yaml

port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
ipv6: true
keep-alive-interval: 30
find-process-mode: strict
external-controller: 127.0.0.1:9090
unified-delay: true
tcp-concurrent: true

# è¿œç¨‹è®¢é˜…
proxy-providers:
  # 69
  provider1:
    type: http
    url: "https://checkhere.top/link/gbWu1r2etF2vVp5b?clash=1"
    interval: 86400
    path: ./provider1.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

  # å†œå¤«
  provider2:
    type: http
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/subs/nfsq/%3Ftoken%3DNnFMEUkTHC4cO6TtzL-mAWHRkcxOD-DI"
    interval: 86400
    path: ./provider2.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

  # è‰¯å¿ƒäº‘
  provider3:
    type: http
    url: "https://liangxin.xyz/api/v1/liangxin?OwO=4aeb4767a72e90166a820ed47afb04a3"
    interval: 86400
    path: ./provider3.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

dns:
  enable: true
  prefer-h3: true
  listen: 0.0.0.0:1053
  ipv6: true
  default-nameserver:
    - system
    - 223.5.5.5
    - 119.29.29.29
    - 8.8.4.4
    - 1.1.1.1
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '+.lan'
    - localhost.ptlogin2.qq.com
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  fallback:
    - tls://8.8.4.4
    - tls://1.1.1.1
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4

proxies:
# ä»£ç†é¢æ¿
proxy-groups:
  # ä»£ç†å‘½å
  # åœ°åŒºèŠ‚ç‚¹
  # è‡ªåŠ¨é€‰æ‹©
  - name: é¦™æ¸¯è‡ªåŠ¨
    type: url-test
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/HongKong.png
    use:
      - provider1
      - provider2
      - provider3
    filter: æ¸¯|ğŸ‡­ğŸ‡°|HK|(?i)Hong
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  - name: ç‹®åŸè‡ªåŠ¨
    type: url-test
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Singapore.png
    use:
      - provider1
      - provider2
      - provider3
    filter: æ–°|ğŸ‡¸ğŸ‡¬|ç‹®|SG|(?i)Singapore
    url: "http://www.gstatic.com/generate_204"
    interval: 300
      
  - name: æ—¥æœ¬è‡ªåŠ¨
    type: url-test
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Japan.png
    use:
      - provider1
      - provider2
      - provider3
    filter: æ—¥|ä¸œäº¬|ğŸ‡¯ğŸ‡µ|JP|(?i)Japan
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  - name: å°æ¹¾è‡ªåŠ¨
    type: url-test
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/TaiWan.png
    use:
      - provider1
      - provider2
      - provider3
    filter: å°|ğŸ‡¨ğŸ‡³|ğŸ‡¹ğŸ‡¼|TW|(?i)Taiwan
    url: "http://www.gstatic.com/generate_204"
    interval: 300

  - name: ç¾å›½è‡ªåŠ¨
    type: url-test
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/UnitedStates.png
    use:
      - provider1
      - provider2
      - provider3
    filter: ç¾|æ´›æ‰çŸ¶|ğŸ‡ºğŸ‡¸|US|(?i)States|American
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    
  # æ‰‹åŠ¨åˆ‡æ¢
  - name: é¦™æ¸¯æ‰‹åŠ¨
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/HongKong.png
    use:
      - provider1
      - provider2
      - provider3
    filter: æ¸¯|ğŸ‡­ğŸ‡°|HK|(?i)Hong

  - name: ç‹®åŸæ‰‹åŠ¨
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Singapore.png
    use:
      - provider1
      - provider2
      - provider3
    filter: æ–°|ğŸ‡¸ğŸ‡¬|ç‹®|SG|(?i)Singapore
      
  - name: æ—¥æœ¬æ‰‹åŠ¨
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Japan.png
    use:
      - provider1
      - provider2
      - provider3
    filter: æ—¥|ä¸œäº¬|ğŸ‡¯ğŸ‡µ|JP|(?i)Japan
     
  - name: å°æ¹¾æ‰‹åŠ¨
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/TaiWan.png
    use:
      - provider1
      - provider2
      - provider3
    filter: å°|ğŸ‡¨ğŸ‡³|ğŸ‡¹ğŸ‡¼|TW|(?i)Taiwan

  - name: ç¾å›½æ‰‹åŠ¨
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/UnitedStates.png
    use:
      - provider1
      - provider2
      - provider3
    filter: ç¾|æ´›æ‰çŸ¶|ğŸ‡ºğŸ‡¸|US|(?i)States|American

  # åˆ†æµèŠ‚ç‚¹
  - name: ChatGPT
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/ChatGPT.png
    proxies:
      - ç‹®åŸè‡ªåŠ¨
      - æ—¥æœ¬è‡ªåŠ¨
      - ç¾å›½è‡ªåŠ¨
      - ç‹®åŸæ‰‹åŠ¨
      - æ—¥æœ¬æ‰‹åŠ¨
      - ç¾å›½æ‰‹åŠ¨

  - name: Copilot
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Copilot.png
    proxies:
      - ç‹®åŸè‡ªåŠ¨
      - æ—¥æœ¬è‡ªåŠ¨
      - ç¾å›½è‡ªåŠ¨
      - ç‹®åŸæ‰‹åŠ¨
      - æ—¥æœ¬æ‰‹åŠ¨
      - ç¾å›½æ‰‹åŠ¨

  - name: Gemini
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Gemini.png
    proxies:
      - é¦™æ¸¯è‡ªåŠ¨
      - ç‹®åŸè‡ªåŠ¨
      - ç¾å›½è‡ªåŠ¨
      - é¦™æ¸¯æ‰‹åŠ¨
      - ç‹®åŸæ‰‹åŠ¨
      - ç¾å›½æ‰‹åŠ¨

  # - name: YouTube
  #   type: select
  #   icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/YouTube.png
  #   proxies:
  #     - é¦™æ¸¯è‡ªåŠ¨
  #     - ç‹®åŸè‡ªåŠ¨
  #     - æ—¥æœ¬è‡ªåŠ¨
  #     - ç¾å›½è‡ªåŠ¨
  #     - é¦™æ¸¯æ‰‹åŠ¨
  #     - ç‹®åŸæ‰‹åŠ¨
  #     - æ—¥æœ¬æ‰‹åŠ¨
  #     - ç¾å›½æ‰‹åŠ¨

  - name: å“”å“©å“”å“©
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Bilibili.png
    proxies:
      - DIRECT
      - é¦™æ¸¯è‡ªåŠ¨
      - å°æ¹¾è‡ªåŠ¨
      - é¦™æ¸¯æ‰‹åŠ¨
      - å°æ¹¾æ‰‹åŠ¨

  - name: è‹¹æœæœåŠ¡
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Apple.png
    proxies:
      - DIRECT

  # - name: å›½å¤–ç½‘ç«™
  #   type: select
  #   icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Global.png
  #   proxies:
  #     - é¦™æ¸¯è‡ªåŠ¨
  #     - ç‹®åŸè‡ªåŠ¨
  #     - æ—¥æœ¬è‡ªåŠ¨
  #     - ç¾å›½è‡ªåŠ¨
  #     - é¦™æ¸¯æ‰‹åŠ¨
  #     - ç‹®åŸæ‰‹åŠ¨
  #     - æ—¥æœ¬æ‰‹åŠ¨
  #     - ç¾å›½æ‰‹åŠ¨     

  - name: å›½å†…ç½‘ç«™
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Domestic.png
    proxies:
      - DIRECT

  - name: å…œåº•åˆ†æµ
    type: select
    icon: https://raw.githubusercontent.com/jianh-ai/klax/main/icon/Final.png
    proxies:
      - é¦™æ¸¯è‡ªåŠ¨
      - ç‹®åŸè‡ªåŠ¨
      - æ—¥æœ¬è‡ªåŠ¨
      - ç¾å›½è‡ªåŠ¨
      - å°æ¹¾è‡ªåŠ¨

# è§„åˆ™é›†
rule-providers:
  # è§„åˆ™é›†å‘½å
  Antiads:
    type: http
    behavior: classical
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main//rule/Antiads.list"
    path: ./ruleset/Antiads.list
    interval: 86400

  Apple:
    type: http
    behavior: classical
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/Apple.list"
    path: ./ruleset/Apple.list
    interval: 86400

  BiliBili:
    type: http
    behavior: classical
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/BiliBili.list"
    path: ./ruleset/BiliBili.list
    interval: 86400

  Copilot:
    type: http
    behavior: classical
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/Copilot.list"
    path: ./ruleset/Copilot.list
    interval: 86400

  Gemini:
    type: http
    behavior: domain
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/Gemini.list"
    path: ./ruleset/Gemini.list
    interval: 86400

  OpenAI:
    type: http
    behavior: classical
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/OpenAI.list"
    path: ./ruleset/OpenAI.list
    interval: 86400

  regioncn:
    type: http
    behavior: domain
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/regioncn.list"
    path: ./ruleset/regioncn.list
    interval: 86400

  regionjp:
    type: http
    behavior: domain
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/regionjp.list"
    path: ./ruleset/regionjp.list
    interval: 86400

  regionus:
    type: http
    behavior: domain
    format: text
    url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/regionus.list"
    path: ./ruleset/regionus.list
    interval: 86400

  # YouTube:
  #   type: http
  #   behavior: classical
  #   format: text
  #   url: "https://raw.githubusercontent.com/jianh-ai/klax/main/rule/YouTube.list"
  #   path: ./ruleset/YouTube.list
  #   interval: 86400

# è§„åˆ™é›†å‘½å+ä»£ç†å‘½å
rules:
  - RULE-SET,Antiads,REJECT,no-resolve
  - RULE-SET,Apple,è‹¹æœæœåŠ¡,no-resolve
  - RULE-SET,BiliBili,å“”å“©å“”å“©,no-resolve
  - RULE-SET,Copilot,Copilot,no-resolve
  - RULE-SET,Gemini,Gemini,no-resolve
  - RULE-SET,OpenAI,ChatGPT,no-resolve
  - RULE-SET,regioncn,å›½å†…ç½‘ç«™,no-resolve
  - RULE-SET,regionjp,æ—¥æœ¬è‡ªåŠ¨,no-resolve
  - RULE-SET,regionus,ç¾å›½è‡ªåŠ¨,no-resolve
  # - RULE-SET,YouTube,YouTube,no-resolve
  - GEOIP,Lan,DIRECT,no-resolve
  - GEOIP,CN,å›½å†…ç½‘ç«™,no-resolve
  - MATCH,å…œåº•åˆ†æµ
